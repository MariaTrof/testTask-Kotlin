"use strict";

function getNewVersions(clientVersions, getState, skipVersion) {
    var state = getState();
    var stateVersions = state.versions || {};
    var newVersions = { versions: {}, state: {} };
    var updated = false;
    Object.keys(stateVersions).forEach(function (key) {
        if (stateVersions[key] !== clientVersions[key] ||
        // If there exists no version we need to push out the initial state
        clientVersions[key] === 0) {
            newVersions.versions[key] = stateVersions[key];
            newVersions.state[key] = state[key];
            updated = true;
        }
    });
    if (skipVersion) {
        skipVersion.forEach(function (key) {
            newVersions.state[key] = state[key];
            updated = true;
        });
    }
    return updated && newVersions;
}
exports.getNewVersions = getNewVersions;